# Отчет по лабораторной работе N 3 по курсу
# "Фундаментальная информатика"

Студент группы: M80-107Б, Павлов Иван Дмитриевич\
Контакты: pavlov.id.2003@gmail.com\
Работа выполнена: 14.09.2021\
Преподаватель: Найденов Иван Евгеньевич\

## 1. Тема

Сети и телекоммуникации в среде ОС linux.

## 2. Цель работы

Изучение и освоение удаленных машин ОС UNIX и приобритение навыков, необходимых для выполнения курсовых и лабораторных работ в среде UNIX, связанных с удаленным подключением.

## 3. Задание

1) Показать умение работать с утилитами, связанными с удаленным подключением в среде ОС linux, предоставить базовый протокол.
2) С помощью скрипта подсчитать количество символов из набора {p, a, v, l, o}, находящихся на нечетных строках файлов с расширением **.txt** на удаленной машине.
3) Найти на удаленной машине зашифрованную картинку с котиком, скопировать ее на компьютер и указать номер.
4) Сгенерировать ssh-ключ и отправить его на сервер.

## 4. Оборудование

Процессор: AMD Ryzen 5 4600H with Radeon Graphics\
ОП: 7851 Мб\
НМД: 256 Гб\
Монитор: 1920x1080\

## 5. Программное обеспечение

Операционная система семейства: linux (ubuntu), версия 20.04.3 LTS\
Интерпретатор команд: bash, версия 5.0.17(1)-release.\
Система программирования: **--**, версия **--**\
Редактор текстов: emacs, версия 25.2.2\
Утилиты операционной системы: **ssh scp rcync curl wget find awk stat**\ 
Прикладные системы и программы: **--**\
Местонахождение и имена файлов программ и данных на домашнем компьютере: --\

## 6. Идея, метод, алгоритм решения задачи

*В формах: словесной, псевдокода, графической [блок схема, диаграмма, рисунок, таблица] или формальные спецификации с пред- и постусловиями.*

Для выполнения первой части работы достаточно будет создать текстовые файлы и с их помощью показать свои навыки в выполнении команд **ssh**, **scp**, **rcync**. С помощью сайта https://http.cat можно продемонстрировать использование команд **curl** и **wget**, скачав две картинки этими утилитами. 
Вторую часть работы я решил реализовать, используя **awk** - редактор обработки текста. С его помощью можно получить искомый ответ на вопрос задачи.
С реализацией третьей части работы мне поможет команда **find** и такие ее параметры, как **-name** и **-exes**.
Четвертая часть работы решается уже определенным и проверенным алгоритмом действий.

## 7. Сценарий выполнения работы

*[план работы, первоначальный текст программы в черновике (можно на отдельном листе) и тесты либо соображения по тестированию]*

Задача 1:
1) Подключимся к удаленной машине с помощью утилиты **ssh**
2) На удаленной машине создадим текстовый файл, с помощью **scp** скопируем его на домашний компьютер, используя **scp**. 
3) Используя **rcync** создадим копию директории ~/data на локально машине.
4) Зайдя на сайт https://http.cat, скачаем оттуда 2 картинки разными способами: **curl** и **wget**.

Задача 2:\
Перед выполнением удалим все файлы, созданные в первой части работы, с помощью команды **rm**.
Подсчитать символы, находящиеся на нечетных строках в текстовых файлах в директории data мне поможет утилита **awk**.

Ее синтаксис прост: **awk '(условие){действие};{действие}' ~/путь к файлу**. Условие выразим так: **(FNR %2 != 0)** - проверка на нечетность переменной **FNR**, которая является номером обрабатываемой строки в файле. Далее необходимо посчитать количество символов в этих строках.

Для подсчета количества символов в строке, входящих в набор **"{p, a, v, l, o}"** можно использовать команду **split($n,c,"l")** , где **n** - номер строки, в нашем случае **n=0**, т.к. команда будет обнулять номер строки с каждой итерацией, c - тип разделителя (в данном случае символьный), "l" - символ из набора. Так как по сути эта операция является рекурсией, первым действием необходимо задать счетчик **n** и к нему прибавить значение **split($0,c,"l")** (вместо "l" подставим каждую букву из моего username), вторым действием вывести искомую **n** на экран.

Чтобы с каждой итерацией на экран не выводились ненужные промежуточные значения **n**, перед действием **{print n}** добавим оператор **END**. Теперь вывод числа на экран будет только после обработки последней записи входного потока. В качестве входного потока я указал пути до всех файлов **.txt**. Ответ на поставленный вопрос задачи: 2050446.

Задача 3:
Прописав команду **find -type f**, я понял, что в директории находятся только файлы с расширением .txt и .data, и так как текстовый файл не может быть картинкой, то предположим, что это .data. Т.к. средний размер картинки составляет 40-100 КБ, то отсортируем найденные файлы по параметрам **-name "data"** и **-exes**, где **exes** является параметрам для указания действий, в данном случае **ls** - отображает все файлы и их размер. Конвейерно применив **sort** и **tail** находим самый большой из файлов **.data** и копируем его на локальную машину, используя **scp**. Номер моей картинки с котиком - 204. 

Задача 4:
1) Пропишем в домашней директории **ssh-keygen**.
2) Пропишем Ssh-copy-id.
3) Теперь я могу подключиться к удаленной машине без пароля.

## 8. Распечатка протокола
*Подклеить листинг окончательного варианта программы с тестовыми примерами, подписанный преподавателем.*

```
ggame@ggame:~/Документы$ ssh pavlov@193.108.113.89 -p 8013
pavlov@193.108.113.89's password:
Last login: Sun Sep 12 16:47:39 2021 from 185.215.176.5
pavlov@6ed3f57ddabc:~$ ls
data
pavlov@6ed3f57ddabc:~$ cd data/
pavlov@6ed3f57ddabc:~/data$ cat > 2155.txt
4965655
54645
pavlov@6ed3f57ddabc:~/data$ scp -P 8013 pavlov@193.108.113.89:/home/pavlov/data/2155.txt .
pavlov@193.108.113.89's password:
2155.txt                                     100%   14    61.8KB/s   00:00
ggame@ggame:~/noob$ rsync -vrh -e "ssh -p 8013" pavlov@1993.108.113.89 ~data/ ~data.123/
sending incremental file list
rsync: link_stat "/home/ggame/noob/pavlov@1993.108.113.89" failed: No such file or directory (2)
rsync: change_dir "/home/ggame/noob//~data" failed: No such file or directory (2)
created directory ~data.123

sent 20 bytes  received 44 bytes  128.00 bytes/sec
total size is 0  speedup is 0.00
rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1207) [sen>
pavlov@6ed3f57ddabc:~/data$  curl https://http.cat/200 -o  cat.jpg
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 27012  100 27012    0     0  83888      0 --:--:-- --:--:-- --:--:-- 83888
pavlov@6ed3f57ddabc:~/data$ wget https://http.cat/200 -o  cat1.jpg
pavlov@6ed3f57ddabc:~/data$ ls
 100        200        487if8f6   cat.jpg    oldvzwup   w1j7k9hx
 14f722dd   200.1      7ofbahnf   cat1.jpg   p4uqyair  '~data.123'
 1zc81ns3   2155.txt   7vkwi16o   kjg2tyd9   q5wmnf08  '~data.copy'
pavlov@6ed3f57ddabc:~/data$ rm 100
pavlov@6ed3f57ddabc:~/data$ rm 200
pavlov@6ed3f57ddabc:~/data$ rm 200.1
pavlov@6ed3f57ddabc:~/data$ rm 2155.txt
pavlov@6ed3f57ddabc:~/data$ rm cat.jpg
pavlov@6ed3f57ddabc:~/data$ rm cat1.jpg
pavlov@6ed3f57ddabc:~/data$ rmdir '~data.123'
pavlov@6ed3f57ddabc:~/data$ ls
14f722dd  487if8f6  7vkwi16o  oldvzwup  q5wmnf08
1zc81ns3  7ofbahnf  kjg2tyd9  p4uqyair  w1j7k9hx
pavlov@6ed3f57ddabc:~/data$ cat > script2.sh
awk '(FNR % 2 != 0){n+=(split($0,c,"p")+split($0,c,"a")+split($0,c,"v")+split($0,c,"l")+split($0,c,"o"))};END{print n}' ~/data/14f722dd/*.txt ~/data/487if8f6/*.txt ~/data/7vkwi16o/*.txt ~/data/oldvzwup/*.txt ~/data/q5wmnf08/*.txt ~/data/w1j7k9hx/*.txt ~/data/1zc81ns3/*.txt ~/data/7ofbahnf/*.txt ~/data/kjg2tyd9/*.txt ~/data/p4uqyair/*.txt
pavlov@6ed3f57ddabc:~/data$ bash script2.sh
2050446
pavlov@6ed3f57ddabc:~/data$ find -type f
pavlov@6ed3f57ddabc:~/data$ find . -name "*.data" -exec ls -s {} \; | sort -n | tail -1
72 ./kjg2tyd9/sudpy.data
ggame@ggame:~$ scp -P 8013 pavlov@193.108.113.89:/home/pavlov/data/kjg2tyd9/sudpy.data .
pavlov@193.108.113.89's password: 
sudpy.data                                                            100%   72KB 296.6KB/s   00:00
ggame@ggame:~$ ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ggame/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/ggame/.ssh/id_rsa
Your public key has been saved in /home/ggame/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:BxqLBcXED+JYGf/THihP2C4Kr4E2MfNBYaSa7fuBlZs ggame@ggame
The key's randomart image is:
+---[RSA 3072]----+
|  .+oBo          |
|  o =o+          |
| . = .+o.        |
|.oo .+ B.+       |
|o+..+ = S +      |
| o=o.o = + .     |
|.o=.E . o .      |
|. .= o .         |
|  oo+            |
+----[SHA256]-----+
ggame@ggame:~$ ssh-copy-id pavlov@193.108.113.89 -p 8013
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
pavlov@193.108.113.89's password:

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh -p '8013' 'pavlov@193.108.113.89'"
and check to make sure that only the key(s) you wanted were added.

ggame@ggame:~$ ssh -p 8013 pavlov@193.108.113.89
Last login: Tue Sep 14 17:06:15 2021 from 185.215.176.5

```

## 9. Дневник отладки

*Должен содержать дату и время сеансов отладки и основные события (ошибки в сценарии и программе, нестандартные ситуации) и краткие комментарии к ним. В дневнике отладки приводятся сведения об использовании других ЭВМ, существенном участии преподавателя и других лиц в написании и отладке программы.*

| № | Лаб. или дом. | Дата | Время | Событие | Действие по исправлению | Примечание |
| - | ------------- | ---- | ----- | ------- | ----------------------- | ---------- |
| 0 | Дом | 15.09.2021 | 01:30 | scp не нашел путь к файлу | Прописал на локальной машине | - |

## 10. Замечания автора по существу работы

Здесь вы можете написать свои замечания касательно работы, которые считаете существенными. Например - “Работу считаю не актуальной по такой-то причине”

## 11. Выводы

Одна из самых важных частей лр. Опишите,  чем вам работа понравилась, чем не понравилась. Расскажите, как по вашему мнению вам пригодятся полученные знания. Что было интересно, а что не очень .

Подведите итог:  чему вы научились (кроме того, что написано в целях ЛР)  потратив время на разработку решения, тестов, картинок и прочего.

Благодаря данной ЛР я узнал много нового об ОС linux, в частности, такие утилиты, как **find** и **awk**, и познакомился с удаленными подключениями в среде linux, более детальное изучение которых поможет мне освоить профессию IT. 